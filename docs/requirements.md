# 朝のAIアシスタント - スマートフォンアプリ化要件定義書

## 📋 プロジェクト概要

### プロジェクト名
朝のAIアシスタント スマートフォンアプリ版

### 目的
既存のWebベース朝のAIアシスタントをスマートフォンアプリ化し、より自然で使いやすい朝の準備サポートを提供する。

## 🎯 現在のWebアプリ分析

### 主要機能
- **音声対話機能**: Web Speech APIを使用した音声認識・合成
- **OpenAI統合**: GPT APIを使用したAI会話
- **カスタム指示管理**: ユーザー定義の朝ルーティン設定
- **プラン機能**: 基本/プラス/プレミアムの段階的機能提供
- **通話ログ**: 過去の会話履歴管理
- **Web検索連携**: プレミアムプランでの外部情報取得

### 技術スタック（現在）
- **フロントエンド**: React 18 + TypeScript + Vite
- **UIライブラリ**: Tailwind CSS + shadcn/ui
- **状態管理**: React Query + React Hook Form
- **音声機能**: Browser Web Speech API
- **その他**: React Router, Zod, date-fns

## 📱 スマートフォンアプリ化要件

### 機能要件

#### 1. 既存機能の移植
- [必須] 音声認識・合成機能の完全移植
- [必須] OpenAI API連携の継続
- [必須] カスタム指示管理機能
- [必須] プラン機能の維持
- [必須] 通話ログ機能
- [必須] Web検索機能（プレミアムプラン）

#### 2. モバイル専用機能
- [必須] **アラーム通知機能**
  - ユーザー指定時間でのプッシュ通知
  - カスタム音声ファイル（10-30秒）での通知音
  - 段階的通知（メイン→30秒後→2分後）
  - スヌーズ機能
- [必須] バイブレーション機能
- [推奨] バックグラウンド実行対応
- [推奨] ウィジェット機能

#### 3. UI/UX要件
- [必須] モバイルファーストのレスポンシブデザイン
- [必須] タッチジェスチャー対応
- [必須] ダークモード対応
- [推奨] ネイティブライクなアニメーション

### 非機能要件

#### 1. パフォーマンス
- 音声認識開始時間: 2秒以内
- AI応答表示時間: OpenAI API応答時間+1秒以内
- アプリ起動時間: 3秒以内

#### 2. 対応プラットフォーム
- **優先度1**: iOS（iPhone）
- **優先度2**: Android
- **開発環境**: PC上での動作確認必須

#### 3. セキュリティ
- OpenAI APIキーのセキュアな保存
- ユーザーデータのローカル暗号化
- 音声データの一時的な扱い

## 🛠️ 技術選択

### 選択技術: PWA + Capacitor

**選択理由:**
1. **PC動作確認**: ブラウザで完全な動作確認が可能
2. **コード再利用**: 既存Reactコードベースを最大限活用
3. **ネイティブ機能**: Capacitorでフルネイティブ機能アクセス
4. **App Store対応**: 正式なアプリとして配布可能
5. **段階的開発**: PWA→Capacitorの段階的移行

### 主要技術スタック
- **ベース**: 現在のReact + TypeScript + Vite
- **PWA**: vite-plugin-pwa
- **ネイティブブリッジ**: Capacitor
- **音声機能**: @capacitor/speech
- **通知機能**: @capacitor/local-notifications
- **その他**: @capacitor/haptics, @capacitor/background-mode

## ⏰ アラーム機能詳細要件

### 基本仕様
- **設定可能時間**: 24時間形式での時間指定
- **繰り返し設定**: 曜日別設定（平日/休日/個別）
- **音声ファイル**: カスタム音声（10-30秒、WAV形式推奨）
- **音声種類**: 複数選択可能（優しい/元気/自然音/音声メッセージ）

### 通知フロー
1. **事前通知**: 設定時間の5分前（オプション）
2. **メイン通知**: 設定時間にカスタム音声で通知
3. **フォローアップ**: 30秒後に追加通知（未応答時）
4. **スヌーズ**: 2分後に再通知（未応答時）
5. **アプリ内アラーム**: 通知タップ時にアプリ内で継続音声

### 制限事項（iOS）
- 単一通知音の最大長: 30秒（実質10-15秒推奨）
- サイレントモード時: システム設定に依存
- バックグラウンド制限: iOS標準制限に準拠

## 📊 ユーザーストーリー

### メインユーザーストーリー
1. **As a** 朝が苦手なユーザー
   **I want** 指定時間にアプリから優しくアラーム通知を受け取りたい
   **So that** 自然に目覚めて朝の準備を始められる

2. **As a** 忙しい朝を過ごすユーザー
   **I want** 音声で朝のルーティンをガイドしてもらいたい
   **So that** 効率的に朝の準備を完了できる

3. **As a** カスタマイズ好きなユーザー
   **I want** 自分だけの朝のルーティンを設定したい
   **So that** 個人のライフスタイルに合わせた準備ができる

## 🚫 制約条件

### 技術制約
- iOS通知音の長さ制限（最大30秒）
- バックグラウンド実行の制限
- Apple App Storeのガイドライン準拠

### 開発制約
- PC上での動作確認必須
- 既存コードベースの最大限活用
- React Native等の新技術学習コストの回避

### **iOS開発環境制約**
- **Mac環境**: iOS開発には通常macOSが必要
- **Apple Developer Account**: 年額$99必須
- **代替手段**: 
  - **MacinCloud**: $30/月のクラウドMac環境（推奨）
  - **AWS EC2 Mac**: $25-40/月
  - **Android先行開発**: Windowsでも可能
  - **GitHub Actions**: CI/CDでのビルド自動化

### ビジネス制約
- 既存のプラン機能の維持
- ユーザーデータ移行不要
- 段階的リリース対応（iOS先行リリース可）
- **リリース速度重視**: 最短3週間でのiOS版リリース目標

## ✅ 成功基準

### 機能面
- [ ] 全既存機能の正常動作
- [ ] アラーム通知の確実な動作
- [ ] 音声機能の品質維持
- [ ] App Storeでの公開

### 体験面
- [ ] ユーザビリティテストでの高評価
- [ ] アプリ起動から音声開始まで3秒以内
- [ ] 通知から反応までのスムーズな流れ

### 技術面
- [ ] PC上での完全な動作確認
- [ ] iOS実機での安定動作
- [ ] メモリ使用量の最適化
- [ ] バッテリー消費の最小化

### **リリース面**
- [ ] **3週間以内のiOS版完成**
- [ ] App Store審査通過
- [ ] MacinCloudまたは代替環境での効率的開発
- [ ] 継続的な機能追加が可能な開発フロー確立 