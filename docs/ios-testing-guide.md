# iOS実機テストガイド

## 🎯 概要
Phase 3まで完了した朝のAIアシスタントアプリをiOS実機で検証するためのガイドです。

## ✅ 実装済み機能
- **音声入力機能**: プラットフォーム判定によるWeb Speech API / Capacitor Speech自動切り替え
- **Web検索機能**: OpenAI Responses APIを使用したリアルタイム検索
- **アラーム機能**: LocalNotificationsを使用した段階的通知システム
- **プラットフォーム適応**: ServiceFactoryによる自動サービス選択

## 🔧 事前準備

### 必要なツール
- **Xcode**: 最新版（App Store からインストール）
- **Apple Developer Account**: 実機テスト用（無料アカウントでも可）
- **iOS実機**: iPhone（iOS 13以降推奨）

### プロジェクト設定
1. **ビルドの実行**:
   ```bash
   ./ios_build.sh
   ```

2. **Xcodeでプロジェクトを開く**:
   ```bash
   npx cap open ios
   ```

## 📱 iOS実機での検証項目

### 1. プラットフォーム判定の確認
- **確認方法**: アプリ起動時のコンソールログ
- **期待値**: `📱 iOS: Capacitor音声サービスを使用します`
- **Safari開発者ツールでログ確認**:
  1. iPhone設定 > Safari > 詳細 > Web Inspector を有効
  2. Mac Safari > 開発 > [デバイス名] > [アプリ名]

### 2. 音声入力機能のテスト
#### 🎤 マイク許可の確認
- **操作**: 初回音声入力時にマイク許可を要求
- **期待値**: 許可後に音声認識が正常に動作

#### 🗣️ 音声認識精度
- **テストケース**:
  - 「おはよう」
  - 「今日の天気を教えて」
  - 「川崎の天気を調べて」
- **期待値**: 日本語の正確な認識と応答

#### 🔊 音声合成
- **確認項目**: AIの応答が音声で再生される
- **期待値**: 自然な日本語音声での読み上げ

### 3. Web検索機能のテスト
#### 🔍 Responses API連携
- **前提条件**: OpenAI APIキーが設定済み
- **テストケース**:
  - 「最新のニュースを教えて」
  - 「今日の為替レートは？」
  - 「川崎市の天気予報」

#### 📊 検索結果の表示
- **期待値**: リアルタイム情報を含む適切な応答
- **確認項目**: Web検索テストコンポーネントでの直接テスト

### 4. アラーム・通知機能のテスト
#### 🔔 通知許可
- **操作**: 初回アラーム設定時に通知許可を要求
- **期待値**: 許可後にローカル通知が正常に動作

#### ⏰ アラーム動作
- **テストケース**:
  - 1分後のアラーム設定
  - アプリをバックグラウンドにしてアラーム待機
  - 通知タップでのアプリ復帰

#### 🔄 段階的通知
- **確認項目**: 
  - メイン通知（即座）
  - フォローアップ通知（30秒後）
  - スヌーズ通知（2分後）

### 5. 総合動作確認
#### 🎯 朝のルーティン実行
1. **アプリ起動**: プラットフォーム情報の確認
2. **音声で挨拶**: 「おはよう」→ AI応答
3. **Web検索実行**: 「今日のニュースを教えて」
4. **アラーム設定**: 2分後のアラーム
5. **バックグラウンド**: ホーム画面に移動
6. **通知確認**: アラーム通知の受信とタップ

## 🐛 トラブルシューティング

### 音声認識が動作しない場合
1. **マイク許可の確認**: 設定 > プライバシーとセキュリティ > マイク
2. **ネットワーク接続**: 音声認識にはインターネット接続が必要
3. **コンソールエラー**: Safari開発者ツールでエラーログを確認

### Web検索が動作しない場合
1. **APIキー確認**: OpenAI APIキーが正しく設定されているか
2. **ネットワーク**: HTTPS接続が正常か
3. **Responses API**: プランがResponses APIに対応しているか

### 通知が表示されない場合
1. **通知許可**: 設定 > 通知 > [アプリ名] で許可されているか
2. **おやすみモード**: iPhoneのおやすみモードが無効か
3. **バックグラウンド**: アプリがバックグラウンドで実行されているか

## 📈 パフォーマンス確認

### 応答速度の測定
- **音声認識**: 発話終了から認識完了まで
- **AI応答**: 認識完了からAI応答まで
- **音声合成**: AI応答から音声再生開始まで

### メモリ使用量
- **Xcode Debug Navigator**: メモリ使用量の監視
- **期待値**: 100MB以下での安定動作

### バッテリー消費
- **設定 > バッテリー**: アプリの消費量確認
- **長時間使用テスト**: 30分間の連続使用

## 🚀 次のステップ

### 成功時
1. **App Store Connect準備**: メタデータとスクリーンショット
2. **プライバシーポリシー**: 音声データ取り扱いの明記
3. **審査用ビルド**: Release configurationでのビルド

### 問題発見時
1. **ログ収集**: コンソールエラーとクラッシュログ
2. **再現手順**: 問題の詳細な記録
3. **修正と再テスト**: 問題修正後の再検証

## 📞 サポート情報
- **開発環境**: WSL2 + MacinCloud（推奨）
- **テスト環境**: iOS 13+
- **対応機種**: iPhone 7以降

---

このガイドに従って実機テストを実行し、すべての機能が正常に動作することを確認してください。